---
layout: topic
module: 操作系统
title:  存储系统
date:   2017-08-25
---

#### 存储器层次结构

* CPU寄存器
* CPU高速缓存L1
    * 数据缓存
    * 指令缓存
* CPU高速缓存L2
* CPU高速缓存L3
* 主存
* 本地磁盘
* 远程存储

局部性，可用来衡量一个程序的好坏，具有良好局部性的程序具有以下特点:

* 倾向于访问最近访问过的数据项
* 倾向于访问邻近于最近访问过的数据项的数据项
* 倾向于从存储器层次结构中较高层次处访问数据项

缓存，上层缓存设备作为下层缓存设备中数据的缓冲区

* 缓存块: 缓存的最小单位
* 缓存读
    * 读命中: cache hit
    * 读未命中: cache miss
    * 读命中率
* 缓存写
    * 直写
    * 缓冲写
* 缓存淘汰: LRU
* 缓存局部性
    * 时间局部性: 缓存块连续命中
    * 空间局部性: 缓存块中其它对象命中

#### 磁盘

* 磁盘结构
    * 盘片
        * 磁道
            * 扇区: 512字节
    * 柱面: 相同大小磁道的集合
    * 主轴
    * 磁头
* 磁盘容量: 盘片数 x 盘面数 x 磁道数 x 扇区数 x 扇区字节数
* 磁盘读写: 以扇区为单位
    * 寻道时间
    * 旋转时间
    * 传送时间
* 磁盘控制器
    * 映射表: 逻辑块号 -&gt; (盘面, 磁道, 扇区)
    * 缓冲区
        * 读缓冲区
        * 写缓冲区
* DMA(直接内存访问)
    * 磁盘控制器映射到端口a
    * CPU向磁盘发送指令，告诉磁盘读数据的逻辑块号和主存地址
    * 磁盘接收到CPU的读命令，将逻辑块号翻译为扇区地址
    * 磁盘读取扇区的内容，并将内容直接传送到指定主存地址
    * 磁盘控制器向CPU发送一个中断信号来通知CPU
